

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fast GB Waveforms and Likelihoods &mdash; gbgpu  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extending GBGPU Waveforms" href="derivedwaves.html" />
    <link rel="prev" title="gbgpu: GPU/CPU Galactic Binary Waveforms" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >

          
          
          <a href="../index.html" class="icon icon-home">
            gbgpu
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fast GB Waveforms and Likelihoods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU"><code class="docutils literal notranslate"><span class="pre">GBGPU</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.A"><code class="docutils literal notranslate"><span class="pre">GBGPU.A</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.A_out"><code class="docutils literal notranslate"><span class="pre">GBGPU.A_out</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.E"><code class="docutils literal notranslate"><span class="pre">GBGPU.E</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.E_out"><code class="docutils literal notranslate"><span class="pre">GBGPU.E_out</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.T"><code class="docutils literal notranslate"><span class="pre">GBGPU.T</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.T_out"><code class="docutils literal notranslate"><span class="pre">GBGPU.T_out</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.X"><code class="docutils literal notranslate"><span class="pre">GBGPU.X</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.X_out"><code class="docutils literal notranslate"><span class="pre">GBGPU.X_out</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.Y"><code class="docutils literal notranslate"><span class="pre">GBGPU.Y</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.Y_out"><code class="docutils literal notranslate"><span class="pre">GBGPU.Y_out</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.Z"><code class="docutils literal notranslate"><span class="pre">GBGPU.Z</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.Z_out"><code class="docutils literal notranslate"><span class="pre">GBGPU.Z_out</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.citation"><code class="docutils literal notranslate"><span class="pre">GBGPU.citation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.fill_global_func"><code class="docutils literal notranslate"><span class="pre">GBGPU.fill_global_func</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.fill_global_template"><code class="docutils literal notranslate"><span class="pre">GBGPU.fill_global_template()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.freqs"><code class="docutils literal notranslate"><span class="pre">GBGPU.freqs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.generate_global_template"><code class="docutils literal notranslate"><span class="pre">GBGPU.generate_global_template()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.get_ll"><code class="docutils literal notranslate"><span class="pre">GBGPU.get_ll()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.get_ll_func"><code class="docutils literal notranslate"><span class="pre">GBGPU.get_ll_func</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.information_matrix"><code class="docutils literal notranslate"><span class="pre">GBGPU.information_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.inject_signal"><code class="docutils literal notranslate"><span class="pre">GBGPU.inject_signal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.orbits"><code class="docutils literal notranslate"><span class="pre">GBGPU.orbits</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.prepare_additional_args"><code class="docutils literal notranslate"><span class="pre">GBGPU.prepare_additional_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.run_wave"><code class="docutils literal notranslate"><span class="pre">GBGPU.run_wave()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.xp"><code class="docutils literal notranslate"><span class="pre">GBGPU.xp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.special_get_N"><code class="docutils literal notranslate"><span class="pre">GBGPU.special_get_N()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.shift_frequency"><code class="docutils literal notranslate"><span class="pre">GBGPU.shift_frequency()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#gbgpu.gbgpu.GBGPU.add_to_argS"><code class="docutils literal notranslate"><span class="pre">GBGPU.add_to_argS()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="derivedwaves.html">Extending GBGPU Waveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">GBGPU Utility Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GBGPU_tutorial.html">GBGPU Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GBGPU_tutorial.html#Generating-Galactic-binary-waveforms">Generating Galactic binary waveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GBGPU_tutorial.html#Adding-additional-GB-astrophysics">Adding additional GB astrophysics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GBGPU_tutorial.html#Calculating-the-Information-Matrix">Calculating the Information Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GBGPU_tutorial.html#Utility-functions">Utility functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GBGPU_tutorial.html#Citations">Citations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: coral" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gbgpu</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Fast GB Waveforms and Likelihoods</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user/main.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="../index.html" class="btn btn-neutral float-left" title="gbgpu: GPU/CPU Galactic Binary Waveforms" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="derivedwaves.html" class="btn btn-neutral float-right" title="Extending GBGPU Waveforms" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="fast-gb-waveforms-and-likelihoods">
<h1>Fast GB Waveforms and Likelihoods<a class="headerlink" href="#fast-gb-waveforms-and-likelihoods" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gbgpu.gbgpu.</span></span><span class="sig-name descname"><span class="pre">GBGPU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Orbits</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GBGPUBase</span></code></p>
<p>Inherit this class to expand on GBGPU waveforms.</p>
<p>The required methods to be added are shown below.</p>
<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.A">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">A</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.A" title="Link to this definition"></a></dt>
<dd><p>return A channel reshaped based on number of binaries</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.A_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">A_out</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.A_out" title="Link to this definition"></a></dt>
<dd><p>A channel.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.E">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">E</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.E" title="Link to this definition"></a></dt>
<dd><p>return E channel reshaped based on number of binaries</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.E_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">E_out</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.E_out" title="Link to this definition"></a></dt>
<dd><p>E channel.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.T">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">T</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.T" title="Link to this definition"></a></dt>
<dd><p>return T channel reshaped based on number of binaries</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.T_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">T_out</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.T_out" title="Link to this definition"></a></dt>
<dd><p>T channel.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.X">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">X</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.X" title="Link to this definition"></a></dt>
<dd><p>return X channel reshaped based on number of binaries</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.X_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">X_out</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.X_out" title="Link to this definition"></a></dt>
<dd><p>X channel.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.Y">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Y</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.Y" title="Link to this definition"></a></dt>
<dd><p>return Y channel reshaped based on number of binaries</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.Y_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Y_out</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.Y_out" title="Link to this definition"></a></dt>
<dd><p>Y channel.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.Z">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Z</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.Z" title="Link to this definition"></a></dt>
<dd><p>return Z channel reshaped based on number of binaries</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.Z_out">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Z_out</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.Z_out" title="Link to this definition"></a></dt>
<dd><p>Z channel.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.citation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">citation</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.citation" title="Link to this definition"></a></dt>
<dd><p>Get citations for this class</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.fill_global_func">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fill_global_func</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.fill_global_func" title="Link to this definition"></a></dt>
<dd><p>fill_global c func.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.fill_global_template">
<span class="sig-name descname"><span class="pre">fill_global_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">templates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_freq_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.fill_global_template" title="Link to this definition"></a></dt>
<dd><p>Fill many global templates with waveforms</p>
<p>This method takes already generated waveforms (<code class="docutils literal notranslate"><span class="pre">A,</span> <span class="pre">E,</span> <span class="pre">start_inds</span></code>)
and their associated grouping index (<code class="docutils literal notranslate"><span class="pre">group_index</span></code>) and fills
buffer tempalte arrays (<code class="docutils literal notranslate"><span class="pre">templates</span></code>).</p>
<p>This method combines waveforms that have already been created.
When a user does not have the waveforms in hand, they should
use the <a class="reference internal" href="#gbgpu.gbgpu.GBGPU.generate_global_template" title="gbgpu.gbgpu.GBGPU.generate_global_template"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_global_template()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group_index</strong> (<em>1D double int32 xp.ndarray</em>) – Index indicating to which template each individual binary belongs.</p></li>
<li><p><strong>templates</strong> (<em>3D complex128 xp.ndarray</em>) – Buffer array for template output to filled in place.
The shape is <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">templates,</span> <span class="pre">2,</span> <span class="pre">data_length)</span></code>. The <code class="docutils literal notranslate"><span class="pre">2</span></code> is
for the <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">E</span></code> TDI channels in that order.</p></li>
<li><p><strong>A</strong> (<em>1D</em><em> or </em><em>2D complex128 xp.ndarray</em>) – TDI A channel template values for each individual binary.
The shape if 2D is <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">binaries,</span> <span class="pre">N)''.</span> <span class="pre">In</span> <span class="pre">1D,</span> <span class="pre">the</span> <span class="pre">array</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">arranged</span> <span class="pre">so</span> <span class="pre">that</span>
<span class="pre">it</span> <span class="pre">resembles</span> <span class="pre">``(number</span> <span class="pre">of</span> <span class="pre">binaries,</span> <span class="pre">N).transpose().flatten()</span></code>.
After running waveforms, this is how <code class="docutils literal notranslate"><span class="pre">self.A_out</span></code> is arranged.</p></li>
<li><p><strong>E</strong> (<em>1D 2D complex128 xp.ndarray</em>) – TDI E channel template values for each individual binary.
The shape if 2D is <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">binaries,</span> <span class="pre">N)''.</span> <span class="pre">In</span> <span class="pre">1D,</span> <span class="pre">the</span> <span class="pre">array</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">arranged</span> <span class="pre">so</span> <span class="pre">that</span>
<span class="pre">it</span> <span class="pre">resembles</span> <span class="pre">``(number</span> <span class="pre">of</span> <span class="pre">binaries,</span> <span class="pre">N).transpose().flatten()</span></code>.
After running waveforms, this is how <code class="docutils literal notranslate"><span class="pre">self.E_out</span></code> is arranged.</p></li>
<li><p><strong>start_inds</strong> (<em>1D int32 xp.ndarray</em>) – The start indices of each binary waveform
in the full Fourier transform: <code class="docutils literal notranslate"><span class="pre">int(f0/T)</span> <span class="pre">-</span> <span class="pre">N/2</span></code>.</p></li>
<li><p><strong>N</strong> (<em>int</em><em>, </em><em>optional</em>) – The length of the A and E channels for each individual binary.
When <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">E</span></code> are 1D, <code class="docutils literal notranslate"><span class="pre">N</span></code> must be given. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>start_freq_ind</strong> (<em>int</em><em>, </em><em>optional</em>) – Starting index into the frequency-domain data stream
for the first entry of <code class="docutils literal notranslate"><span class="pre">templates</span></code>. This is used if a subset of a full data stream
is presented for the computation.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If data arrays are NumPy/CuPy while tempalte arrays are CuPy/NumPy.</p></li>
<li><p><strong>ValueError</strong> – Inputs are not correctly provided.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.freqs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">freqs</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.freqs" title="Link to this definition"></a></dt>
<dd><p>Return frequencies associated with each signal</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.generate_global_template">
<span class="sig-name descname"><span class="pre">generate_global_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">templates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_freq_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.generate_global_template" title="Link to this definition"></a></dt>
<dd><p>Generate global templates from binary parameters</p>
<p>Generate waveforms in batches and then combine them into
global fit templates. This method wraps <a class="reference internal" href="#gbgpu.gbgpu.GBGPU.fill_global_template" title="gbgpu.gbgpu.GBGPU.fill_global_template"><code class="xref py py-func docutils literal notranslate"><span class="pre">fill_global_template()</span></code></a>
by building the waveforms first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>2D double np.ndarrays</em>) – Parameters of all binaries to be calculated.
The shape is <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">parameters,</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">binaries)</span></code>.</p></li>
<li><p><strong>group_index</strong> (<em>1D double int32 xp.ndarray</em>) – Index indicating to which template each individual binary belongs.</p></li>
<li><p><strong>templates</strong> (<em>3D complex128 xp.ndarray</em>) – Buffer array for template output to filled in place.
The shape is <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">templates,</span> <span class="pre">2,</span> <span class="pre">data_length)</span></code>. The <code class="docutils literal notranslate"><span class="pre">2</span></code> is
for the <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">E</span></code> TDI channels in that order.</p></li>
<li><p><strong>start_freq_ind</strong> (<em>int</em><em>, </em><em>optional</em>) – Starting index into the frequency-domain data stream
for the first entry of <code class="docutils literal notranslate"><span class="pre">templates</span></code>. This is used if a subset of a full data stream
is presented for the computation.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Passes keyword arguments to <a class="reference internal" href="#gbgpu.gbgpu.GBGPU.run_wave" title="gbgpu.gbgpu.GBGPU.run_wave"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_wave()</span></code></a> function above.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.get_ll">
<span class="sig-name descname"><span class="pre">get_ll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_marginalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_freq_ind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.get_ll" title="Link to this definition"></a></dt>
<dd><p>Get batched log likelihood</p>
<p>Generate the individual log likelihood for a batched set of Galactic binaries.
This is also GPU/CPU agnostic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>2D double np.ndarrays</em>) – Parameters of all binaries to be calculated.
The shape is <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">parameters,</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">binaries)</span></code>.</p></li>
<li><p><strong>data</strong> (<em>length 2 list</em><em> of </em><em>1D</em><em> or </em><em>2D complex128 xp.ndarrays</em>) – List of arrays representing the data
stream. These should be CuPy arrays if running on the GPU, NumPy
arrays if running on a CPU. The list should be [A channel, E channel].
Should be 1D if only one data stream is analyzed. If 2D, shape is
<code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">data</span> <span class="pre">streams,</span> <span class="pre">data_length)</span></code>. If 2D,
user must also provide <code class="docutils literal notranslate"><span class="pre">data_index</span></code> kwarg.</p></li>
<li><p><strong>psd</strong> (<em>length 2 list</em><em> of </em><em>1D</em><em> or </em><em>2D double xp.ndarrays</em>) – List of arrays representing
the power spectral density (PSD) in the noise.
These should be CuPy arrays if running on the GPU, NumPy
arrays if running on a CPU. The list should be [A channel, E channel].
Should be 1D if only one PSD is analyzed. If 2D, shape is
<code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">PSDs,</span> <span class="pre">data_length)</span></code>. If 2D,
user must also provide <code class="docutils literal notranslate"><span class="pre">noise_index</span></code> kwarg.</p></li>
<li><p><strong>phase_marginalize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, marginalize over the initial phase.
Default is False.</p></li>
<li><p><strong>start_freq_ind</strong> (<em>int</em><em>, </em><em>optional</em>) – Starting index into the frequency-domain data stream
for the first entry of <code class="docutils literal notranslate"><span class="pre">data</span></code>/<code class="docutils literal notranslate"><span class="pre">psd</span></code>. This is used if a subset of a full data stream
is presented for the computation. If providing mutliple data streams in <code class="docutils literal notranslate"><span class="pre">data</span></code>, this single
start index value will apply to all of them.</p></li>
<li><p><strong>data_index</strong> (<em>1D xp.int32 array</em><em>, </em><em>optional</em>) – If providing 2D <code class="docutils literal notranslate"><span class="pre">data</span></code>, need to provide <code class="docutils literal notranslate"><span class="pre">data_index</span></code>
to indicate the data stream associated with each waveform for which the log-Likelihood
is being computed. For example, if you have 100 binaries with 5 different data streams,
<code class="docutils literal notranslate"><span class="pre">data_index</span></code> will be a length-100 xp.int32 array with values 0 to 4, indicating the specific
data stream to use for each source.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will be filled with zeros and only analyzed with the first
data stream given. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>noise_index</strong> (<em>1D xp.int32 array</em><em>, </em><em>optional</em>) – If providing 2D <code class="docutils literal notranslate"><span class="pre">psd</span></code>, need to provide <code class="docutils literal notranslate"><span class="pre">noise_index</span></code>
to indicate the PSD associated with each waveform for which the log-Likelihood
is being computed. For example, if you have 100 binaries with 5 different PSDs,
<code class="docutils literal notranslate"><span class="pre">noise_index</span></code> will be a length-100 xp.int32 array with values 0 to 4, indicating the specific
PSD to use for each source.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will be filled with zeros and only analyzed with the first
PSD given. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Passes keyword arguments to the <a class="reference internal" href="#gbgpu.gbgpu.GBGPU.run_wave" title="gbgpu.gbgpu.GBGPU.run_wave"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_wave()</span></code></a> method.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If data arrays are NumPy/CuPy while template arrays are CuPy/NumPy.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Log likelihood values associated with each binary.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>1D double np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.get_ll_func">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_ll_func</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.get_ll_func" title="Link to this definition"></a></dt>
<dd><p>get_ll c func.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.information_matrix">
<span class="sig-name descname"><span class="pre">information_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter_transforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">easy_central_difference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.information_matrix" title="Link to this definition"></a></dt>
<dd><p>Get the information matrix for a batch.</p>
<p>This function computes the Information matrix for a batch of Galactic binaries.
It uses a 2nd order calculation for the derivative if <code class="docutils literal notranslate"><span class="pre">easy_central_difference</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>:</p>
<p>..math:: frac{dh}{dlambda_i} = frac{-h(lambda_i + 2epsilon) + h(lambda_i - 2epsilon) + 8(h(lambda_i + epsilon) - h(lambda_i - epsilon))}{12epsilson}</p>
<p>Otherwise, it will just calculate the derivate with a first-order central difference.</p>
<p>This function maps all parameter values to 1. For example, if the square root of
the diagonal of the associated covariance matrix is 1e-7 for the frequency
parameter, then the standard deviation in the frequency is <code class="docutils literal notranslate"><span class="pre">1e-7</span> <span class="pre">*</span> <span class="pre">f0</span></code>. To
properly use with covariance values not on the diagonal, they will have to be
multipled by the parameters: <span class="math notranslate nohighlight">\(C_{ij} \vec{\theta}_j\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>2D double np.ndarrays</em>) – Parameters of all binaries to be calculated.
The shape is <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">parameters,</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">binaries)</span></code>.
See <a class="reference internal" href="#gbgpu.gbgpu.GBGPU.run_wave" title="gbgpu.gbgpu.GBGPU.run_wave"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_wave()</span></code></a> for more information on the adjustable
number of parameters when calculating for a third body.</p></li>
<li><p><strong>eps</strong> (<em>double</em><em>, </em><em>optional</em>) – Step to take when calculating the derivative.
The step is relative difference. Default is <code class="docutils literal notranslate"><span class="pre">1e-9</span></code>.</p></li>
<li><p><strong>parameter_transforms</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing the parameter transform
functions. The keys in the dict should be the index associated with the parameter.
The items should be the actual transform function. Default is no transforms (<code class="docutils literal notranslate"><span class="pre">{}</span></code>).</p></li>
<li><p><strong>inds</strong> (<em>1D int np.ndarray</em><em>, </em><em>optional</em>) – Numpy array with the indexes of the parameters to
test in the Information matrix. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>. When it is not given, it defaults to
all parameters.</p></li>
<li><p><strong>N</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points for the waveform. Same as the <code class="docutils literal notranslate"><span class="pre">N</span></code> parameter in
<a class="reference internal" href="#gbgpu.gbgpu.GBGPU.run_wave" title="gbgpu.gbgpu.GBGPU.run_wave"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_wave()</span></code></a>. We recommend using higher <code class="docutils literal notranslate"><span class="pre">N</span></code> in the Information Matrix
computation because of the numerical derivatives. Default is <code class="docutils literal notranslate"><span class="pre">1024</span></code>.</p></li>
<li><p><strong>psd_func</strong> (<em>object</em><em>, </em><em>optional</em>) – Function to compute the PSD for the A and E channels.
Must take on argument: the frequencies as an xp.ndarray. When <code class="docutils literal notranslate"><span class="pre">None</span></code>,
it attemps to use the sensitivity functions from LISA Analysis Tools.</p></li>
<li><p><strong>psd_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments for the TDI noise generator. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>easy_central_difference</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compute the derivatives with
a first-order central difference computation. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, use the higher order
derivative that computes two more waveforms during the derivative calculation.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>return_gpu</strong> (<em>False</em><em>, </em><em>optional</em>) – If True and self.use_gpu is True, return Information
matrices in cupy array. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Information Matrices for all binaries with shape: <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">of</span> <span class="pre">binaries,</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">parameters,</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">parameters)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>3D xp.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Step size issues.</p></li>
<li><p><strong>ModuleNotFoundError</strong> – LISA Analysis Tools package not available.
    Occurs when NOT providing <code class="docutils literal notranslate"><span class="pre">psd_func</span></code> kwarg.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.inject_signal">
<span class="sig-name descname"><span class="pre">inject_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">126232599.05418241</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.inject_signal" title="Link to this definition"></a></dt>
<dd><p>Inject a single signal</p>
<p>Provides the injection of a single signal into a data stream with frequencies
spanning from 0.0 to fmax with 1/T spacing (from Fourier transform).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>list</em><em>, </em><em>tuple</em><em>, or </em><em>1D double np.array</em>) – Arguments to provide to
<a class="reference internal" href="#gbgpu.gbgpu.GBGPU.run_wave" title="gbgpu.gbgpu.GBGPU.run_wave"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_wave()</span></code></a> to build the TDI templates for injection.</p></li>
<li><p><strong>fmax</strong> (<em>double</em><em>, </em><em>optional</em>) – Maximum frequency to use in data stream.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, will use <code class="docutils literal notranslate"><span class="pre">1/(2</span> <span class="pre">*</span> <span class="pre">dt)</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Observation time in seconds. Default is <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">*</span> <span class="pre">YRSID_SI</span></code>.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Observation cadence in seconds. Default is <code class="docutils literal notranslate"><span class="pre">10.0</span></code> seconds.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Passes kwargs to <a class="reference internal" href="#gbgpu.gbgpu.GBGPU.run_wave" title="gbgpu.gbgpu.GBGPU.run_wave"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_wave()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>NumPy arrays for the A channel and</dt><dd><p>E channel: <code class="docutils literal notranslate"><span class="pre">(A</span> <span class="pre">channel,</span> <span class="pre">E</span> <span class="pre">channel)</span></code>. Need to convert to CuPy if working
on GPU.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of 1D np.ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.orbits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orbits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Orbits</span></em><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.orbits" title="Link to this definition"></a></dt>
<dd><p>Orbits class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.prepare_additional_args">
<span class="sig-name descname"><span class="pre">prepare_additional_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.prepare_additional_args" title="Link to this definition"></a></dt>
<dd><p>Prepare the arguments special to this class</p>
<p>This function must take in the extra <code class="docutils literal notranslate"><span class="pre">args</span></code> input
into <a class="reference internal" href="#gbgpu.gbgpu.GBGPU.run_wave" title="gbgpu.gbgpu.GBGPU.run_wave"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GBGPU.run_wave()</span></code></a> and transform them as needed
to input into the rest of the code. If using GPUs,
this is where the parameters are copied to GPUs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> (<em>tuple</em>) – Any additional args to be dealt with.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New args. In the rest of the code this is <code class="docutils literal notranslate"><span class="pre">add_args</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.run_wave">
<span class="sig-name descname"><span class="pre">run_wave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fddot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iota</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">126232599.05418241</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oversample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdi2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.run_wave" title="Link to this definition"></a></dt>
<dd><p>Create waveforms in batches.</p>
<p>This call creates the TDI templates in batches.</p>
<p>The parameters and code below are based on an implementation of Fast GB
in the LISA Data Challenges’ <code class="docutils literal notranslate"><span class="pre">ldc</span></code> package.</p>
<p>This class can be inherited to build fast waveforms for systems
with additional astrophysical effects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amp</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Amplitude parameter.</p></li>
<li><p><strong>f0</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Initial frequency of gravitational
wave in Hz.</p></li>
<li><p><strong>fdot</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Initial time derivative of the
frequency given as Hz/s.</p></li>
<li><p><strong>fddot</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Initial second derivative with
respect to time of the frequency given in Hz/s^2.</p></li>
<li><p><strong>phi0</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Initial phase angle of gravitational
wave given in radians.</p></li>
<li><p><strong>iota</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Inclination of the Galactic binary
orbit given in radians.</p></li>
<li><p><strong>psi</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Polarization angle of the Galactic
binary orbit in radians.</p></li>
<li><p><strong>lam</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Ecliptic longitutude of the source
given in radians.</p></li>
<li><p><strong>beta</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Ecliptic Latitude of the source
given in radians. This is converted to the spherical polar angle.</p></li>
<li><p><strong>*args</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Flexible parameter to allow for a flexible
number of argmuments when inherited by other classes.
If running a circular Galactic binarys, <code class="docutils literal notranslate"><span class="pre">args</span> <span class="pre">=</span> <span class="pre">()</span></code>.
If <code class="docutils literal notranslate"><span class="pre">len(args)</span> <span class="pre">!=</span> <span class="pre">0</span></code>, then the inheriting class must have a
<code class="docutils literal notranslate"><span class="pre">prepare_additional_args</span></code> method.</p></li>
<li><p><strong>N</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points in waveform.
This should be determined by the initial frequency, <code class="docutils literal notranslate"><span class="pre">f0</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, will use <a class="reference internal" href="utils.html#gbgpu.utils.utility.get_N" title="gbgpu.utils.utility.get_N"><code class="xref py py-func docutils literal notranslate"><span class="pre">gbgpu.utils.utility.get_N()</span></code></a> function to determine proper <code class="docutils literal notranslate"><span class="pre">N</span></code>.</p></li>
<li><p><strong>T</strong> (<em>double</em><em>, </em><em>optional</em>) – Observation time in seconds. Default is <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">*</span> <span class="pre">YRSID_SI</span></code>.</p></li>
<li><p><strong>dt</strong> (<em>double</em><em>, </em><em>optional</em>) – Observation cadence in seconds. Default is <code class="docutils literal notranslate"><span class="pre">10.0</span></code> seconds.</p></li>
<li><p><strong>oversample</strong> (<em>int</em><em>, </em><em>optional</em>) – Oversampling factor compared to the determined <code class="docutils literal notranslate"><span class="pre">N</span></code>
value. Final N will be <code class="docutils literal notranslate"><span class="pre">oversample</span> <span class="pre">*</span> <span class="pre">N</span></code>. This is only used if N is
not provided. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>tdi2</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, produce the TDI channels for TDI 2nd-generation.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, produce TDI 1st-generation. Technically, the current TDI computation
is not valid for generic LISA orbits, which are dealth with with 2nd-generation TDI,
only those with an “equal-arm length” condition. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>Raises</strong> – ValueError: Length of <code class="docutils literal notranslate"><span class="pre">*args</span></code> is not 0 or 5.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.xp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.xp" title="Link to this definition"></a></dt>
<dd><p>CuPy or NumPy</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.special_get_N">
<span class="sig-name descname"><span class="pre">special_get_N</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oversample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.special_get_N" title="Link to this definition"></a></dt>
<dd><p>Determine proper sampling rate in time domain for slow-part.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amp</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Amplitude parameter.</p></li>
<li><p><strong>f0</strong> (<em>double</em><em> or </em><em>1D double np.ndarray</em>) – Initial frequency of gravitational
wave in Hz.</p></li>
<li><p><strong>T</strong> (<em>double</em>) – Observation time in seconds.</p></li>
<li><p><strong>*args</strong> (<em>tuple</em>) – Args input for beyond-GBGPU functionality.</p></li>
<li><p><strong>oversample</strong> (<em>int</em><em>, </em><em>optional</em>) – Oversampling factor compared to the determined <code class="docutils literal notranslate"><span class="pre">N</span></code>
value. Final N will be <code class="docutils literal notranslate"><span class="pre">oversample</span> <span class="pre">*</span> <span class="pre">N</span></code>. This is only used if N is
not provided. Default is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of time-domain points recommended for each binary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>1D int32 xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.shift_frequency">
<span class="sig-name descname"><span class="pre">shift_frequency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.shift_frequency" title="Link to this definition"></a></dt>
<dd><p>Shift the evolution of the frequency in the slow part</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fi</strong> (<em>3D double xp.ndarray</em>) – Instantaneous frequencies of the
wave before applying third-body effect at each spacecraft as a function of time.
The shape is <code class="docutils literal notranslate"><span class="pre">(num</span> <span class="pre">binaries,</span> <span class="pre">3</span> <span class="pre">spacecraft,</span> <span class="pre">N)</span></code>.</p></li>
<li><p><strong>xi</strong> (<em>3D double xp.ndarray</em>) – Time at each spacecraft.
The shape is <code class="docutils literal notranslate"><span class="pre">(num</span> <span class="pre">binaries,</span> <span class="pre">3</span> <span class="pre">spacecraft,</span> <span class="pre">N)</span></code>.</p></li>
<li><p><strong>*args</strong> (<em>tuple</em>) – Args returned from <a class="reference internal" href="#gbgpu.gbgpu.GBGPU.prepare_additional_args" title="gbgpu.gbgpu.GBGPU.prepare_additional_args"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_additional_args()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated frequencies with third-body effect.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>3D double xp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gbgpu.gbgpu.GBGPU.add_to_argS">
<span class="sig-name descname"><span class="pre">add_to_argS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fddot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gbgpu.gbgpu.GBGPU.add_to_argS" title="Link to this definition"></a></dt>
<dd><p>Update <code class="docutils literal notranslate"><span class="pre">argS</span></code> in FastGB formalism for third-body effect</p>
<p><code class="docutils literal notranslate"><span class="pre">argS</span></code> is an effective phase that goes into <code class="docutils literal notranslate"><span class="pre">kdotP</span></code> in the construction
of the slow part of the waveform. <code class="docutils literal notranslate"><span class="pre">kdotP</span></code> is then included directly
in the transfer function. See <code class="xref py py-meth docutils literal notranslate"><span class="pre">gbgpu.gbgpu.GBGPU._construct_slow_part()</span></code>
for the use of argS in the larger code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>argS</strong> (<em>3D double xp.ndarray</em>) – Special phase evaluation that goes into <code class="docutils literal notranslate"><span class="pre">kdotP</span></code>.
Shape is <code class="docutils literal notranslate"><span class="pre">(num</span> <span class="pre">binaries,</span> <span class="pre">3</span> <span class="pre">spacecraft,</span> <span class="pre">N)</span></code>.</p></li>
<li><p><strong>f0</strong> (<em>1D double np.ndarray</em>) – Initial frequency of gravitational
wave in Hz.</p></li>
<li><p><strong>fdot</strong> (<em>1D double np.ndarray</em>) – Initial time derivative of the
frequency given as Hz/s.</p></li>
<li><p><strong>fddot</strong> (<em>1D double np.ndarray</em>) – Initial second derivative with
respect to time of the frequency given in Hz/s^2.</p></li>
<li><p><strong>xi</strong> (<em>3D double xp.ndarray</em>) – Time at each spacecraft.
The shape is <code class="docutils literal notranslate"><span class="pre">(num</span> <span class="pre">binaries,</span> <span class="pre">3</span> <span class="pre">spacecraft,</span> <span class="pre">N)</span></code>.</p></li>
<li><p><strong>T</strong> (<em>double</em>) – Observation time in seconds.</p></li>
<li><p><strong>*args</strong> (<em>tuple</em>) – Args returned from <a class="reference internal" href="#gbgpu.gbgpu.GBGPU.prepare_additional_args" title="gbgpu.gbgpu.GBGPU.prepare_additional_args"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_additional_args()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated <code class="docutils literal notranslate"><span class="pre">argS</span></code> with third-body effect</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>3D double xp.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="gbgpu: GPU/CPU Galactic Binary Waveforms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="derivedwaves.html" class="btn btn-neutral float-right" title="Extending GBGPU Waveforms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Michael L. Katz.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>